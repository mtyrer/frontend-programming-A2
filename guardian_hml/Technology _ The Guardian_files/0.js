/* v1.0.15 */var googletag=googletag||{};googletag.cmd=googletag.cmd||[];var __switch_zero=function(){var a=function(){this.units=[]};a.prototype.push=function(a){a.hasWinner=!1,a.deliveryTime=0,a.internalId="sw-"+this.units.length,this.units.push(a),clearTimeout(__switch_zero.userSyncTimeoutHandle)},a.prototype.getById=function(a){for(var b=0;b<this.units.length;b++)if(this.units[b].internalId===a)return this.units[b];return null};var b=function(){this.ready=!1,this.commands=[]};b.prototype.push=function(a){!0===this.ready?a.call(__switch_zero):this.commands.push(a)},b.prototype.setReady=function(){this.ready=!0;for(var a=0;a<this.commands.length;a++)this.commands[a].call(__switch_zero);this.commands=[]},DateNow=function(){return Date.now?Date.now():(new Date).getTime()};var c=function(){this.zeroStartTime=DateNow(),this.mode=null,this.modes={MODE_SERVER:"S",MODE_CLIENT:"C"},this.loadId=null,this.timeoutMs=1e3,this.pollIntervalMs=100,this.pollIntervalHandle=0,this.timeoutHandle=0,this.userSyncTimeoutMs=500,this.userSyncTimeoutHandle=0,this.unusedResults=[],this.pendingCallbackAdUnits=[],this.pollingActive=!1;var c=new a,d=new b;if(void 0!==__switch_zero&&"units"in __switch_zero)for(var e=0;e<__switch_zero.units.length;e++)c.push(__switch_zero.units[e]);if(void 0!==__switch_zero&&"commands"in __switch_zero)for(var f=0;f<__switch_zero.commands.length;f++)d.push(__switch_zero.commands[f]);this.units=c,this.commands=d,this.userSyncTimeoutHandle=setTimeout(function(){__switch_zero.log("User Syncing timeout reached, syncing"),__switch_zero.doUserSync()},this.userSyncTimeoutMs),window.addEventListener?window.addEventListener("message",this.handlePostMessage,!1):window.attachEvent&&window.attachEvent("onmessage",this.handlePostMessage)};return c.prototype.setAdserverDomain=function(a){this.adserverDomain=a},c.prototype.triggerAuctionsFromClient=function(){if(null!==this.mode&&this.mode!==this.modes.MODE_CLIENT)throw this.deliverAdUnits("bad_mode"),new Error("Zero is in a non-client mode ("+this.mode+"). Mode ("+this.modes.MODE_CLIENT+") requested.");if(this.mode=this.modes.MODE_CLIENT,null===this.adserverDomain)throw this.deliverAdUnits("no_domain"),new Error("Switch: No adserver domain specified, make sure to call setAdserverDomain().");this.timeoutHandle=setTimeout(function(){__switch_zero.log("Client-side timeout reached - going to DFP without Switch!"),__switch_zero.deliverAdUnits("client_timeout")},this.timeoutMs);var a=this.generateId();this.setLoadId(a);var b=__switch_zero.readCookie("__SW");null===b&&(b="");for(var c=[],d=0;d<__switch_zero.units.units.length;d++)c.push(parseInt(__switch_zero.units.units[d].switchAdUnitId,10));var e={action:"client",load_id:a,url:window.location.href,zone_ids:c,ip:"RFS",user_agent:navigator.userAgent,switch_user_id:b,zero_start_time:__switch_zero.zeroStartTime,request_time:__switch_zero.dateNow()},f=__switch_zero.createXMLHttpRequest();f.open("POST","//"+__switch_zero.adserverDomain+"/?load_id="+__switch_zero.loadId,!0),f.timeout=__switch_zero.timeoutMs,f.ontimeout=function(){__switch_zero.log("Initial HTTP request timed out to "+__switch_zero.adserverDomain+" - going to DFP without Switch!"),__switch_zero.deliverAdUnits("http_timeout")},f.onerror=function(){__switch_zero.log("Initial HTTP request failed to "+__switch_zero.adserverDomain+" - going to DFP without Switch!"),__switch_zero.deliverAdUnits("http_error")},f.onreadystatechange=function(){4===f.readyState&&(200===f.status?__switch_zero.handleRetrievalResponse(f.status,f.responseText):(__switch_zero.log("Initial HTTP request failure - going to DFP without Switch!"),__switch_zero.deliverAdUnits("http_error")))},f.send(JSON.stringify(e))},c.prototype.createXMLHttpRequest=function(){return new XMLHttpRequest},c.prototype.generateId=function(){var a="CZ-",b=!0;if("crypto"in window&&"undefined"!=typeof Uint32Array){var c=new Uint32Array(3),d=window.crypto.getRandomValues(c);if(void 0!==d){for(var e=0;e<d.length;e++)a+=d[e];b=!1}}if(b&&(a+=(new Date).getTime()+""+4294967295*Math.random(),"performance"in window&&"timing"in window.performance)){var f=0,g=0;window.performance.timing.hasOwnProperty("requestStart")&&(f=window.performance.timing.requestStart),window.performance.timing.hasOwnProperty("requestEnd")&&(g=window.performance.timing.requestEnd),a+=g-f}var h=window.location.href;return h&&h.length>8&&(a+=h[Math.floor(Math.random()*(h.length-8))+8]),a},c.prototype.readCookie=function(a,b){b=void 0===b?window.document:b;for(var c=b.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0===e.indexOf(a+"="))return e.substring(a.length+1,e.length)}return null},c.prototype.writeCookie=function(a,b,c,d){d=void 0===d?window.document:d;var e=new Date;e.setTime(e.getTime()+1e3*c);var f="expires="+e.toUTCString();d.cookie=a+"="+b+"; "+f+"; path=/"},c.prototype.handlePostMessage=function(a){if("string"==typeof a.data&&0===a.data.indexOf("__switch_"))switch(0){case a.data.indexOf("__switch_render_request:"):var b=a.data.substring(24),c=__switch_zero.units.getById(b);if(null===c||!1===c.hasWinner||!c.winner)throw new Error("Switch cannot render for ID "+b+" - ad unit has no creative.");__switch_zero.removeSwitchTargetingFromAdUnit(c);var d=JSON.stringify({creative:c.winner.creative,switchRender:!0});a.source.postMessage(d,"*"),__switch_zero.triggerRenderCallbacks(c);break;case a.data.indexOf("__switch_swid:"):var e=a.data.substring(14);__switch_zero.writeCookie("__SW",e,31536e3)}},c.prototype.triggerRenderCallbacks=function(a){a.hasOwnProperty("renderCallback")&&"function"==typeof a.renderCallback&&a.hasWinner&&a.winner&&a.renderCallback(a.dfpDivId,a.winner)},c.prototype.runDFPCode=function(a){googletag.cmd.push(a)},c.prototype.setDFPSlotTargeting=function(a,b,c){this.runDFPCode(function(){for(var d=googletag.pubads().getSlots(),e=0;e<d.length;e++)if(a.dfpDivId===d[e].getSlotElementId())return void d[e].setTargeting(b,c);throw new Error("Switch cannot set DFP slot targeting for "+a.dfpDivId+" - slot was not found.")})},c.prototype.deliverAdUnits=function(a){__switch_zero.stopPolling();for(var b=0;b<__switch_zero.units.units.length;b++)__switch_zero.deliverAdUnit(__switch_zero.units.units[b],!1,a)},c.prototype.deliverAdUnit=function(a,b,c){if(b=void 0!==b&&b,void 0!==c&&__switch_zero.setDFPSlotTargeting(a,"hb_fail",c),__switch_zero.stopPolling(),__switch_zero.dateNow()-a.deliveryTime<1e3)return void __switch_zero.log("Avoiding race condition - DFP requested to deliver twice in same second.");a.deliveryTime=__switch_zero.dateNow(),a.hasOwnProperty("deliveryCallback")&&"function"==typeof a.deliveryCallback?(this.pendingCallbackAdUnits.push(a),this.runDFPCode(function(){for(var a=__switch_zero.pendingCallbackAdUnits.pop();void 0!==a;)a.deliveryCallback(a.dfpDivId),a=__switch_zero.pendingCallbackAdUnits.pop()})):this.runDFPCode(function(){googletag.display(a.dfpDivId)})},c.prototype.deliverAdUnitWithoutDFP=function(a){if(null===a||!1===a.hasWinner||!a.winner||!a.winner.creative)throw new Error("Switch cannot render for internal ID "+a.internalId+" - ad unit has no creative.");var b=__switch_zero.createIframe("zero-"+a.internalId,a.winner.width,a.winner.height),c=document.getElementById(a.dfpDivId);if(null===c)return __switch_zero.log("DFP div "+a.dfpDivId+" missing, cannot render."),!1;c.appendChild(b);var d=b.contentWindow||b.contentDocument||null;if(null===d)return __switch_zero.log("Cannot grab document element for frame."),!1;d.document&&(d=d.document);var e='<!DOCTYPE html><html><head><title>0</title><meta charset="utf-8" /><base target="_blank"/><style type="text/css">html,body{height:100%;margin:0px;padding:0px;}</style><script>var inDapIF = true;<\/script></head><body>'+a.winner.creative+"</body></html>";return d.open("text/html","replace"),d.write(e),d.close(),__switch_zero.removeSwitchTargetingFromAdUnit(a),__switch_zero.log("Render forced before DFP involvement for ad unit "+a.internalId),!0},c.prototype.createIframe=function(a,b,c){var d=document.createElement("iframe");return d.setAttribute("name",a),d.setAttribute("seamless","seamless"),d.setAttribute("frameSpacing","0"),d.setAttribute("frameBorder","0"),d.setAttribute("scrolling","no"),d.setAttribute("width",b),d.setAttribute("height",c),d},c.prototype.setLoadId=function(a){this.loadId=a,this.runDFPCode(function(){googletag.pubads().setTargeting("_swlid",__switch_zero.loadId)})},c.prototype.callSwitch=function(){if(null!==this.mode&&this.mode!==this.modes.MODE_SERVER)throw new Error("Zero is in a non-server mode ("+this.mode+"). Mode ("+this.modes.MODE_SERVER+") requested.");if(this.mode=this.modes.MODE_SERVER,null===this.loadId)throw this.deliverAdUnits("no_loadid"),new Error("Switch: No load ID specified, make sure to call setLoadId().");if(null===this.adserverDomain)throw this.deliverAdUnits("no_domain"),new Error("Switch: No adserver domain specified, make sure to call setAdserverDomain().");this.pollingActive=!0,this.timeoutHandle=setTimeout(function(){__switch_zero.log("Client-side timeout reached - going to DFP without Switch!"),__switch_zero.deliverAdUnits("client_timeout")},this.timeoutMs),this.sendRequestToAdserver()},c.prototype.log=function(a){console&&console.log&&("string"==typeof a?console.log("Switch Zero: "+a):(console.log("=== Switch Zero ==="),console.log(a),console.log("===================")))},c.prototype.stopPolling=function(){__switch_zero.pollingActive=!1,clearInterval(__switch_zero.pollIntervalHandle),clearInterval(__switch_zero.timeoutHandle)},c.prototype.handleRetrievalResponse=function(a,b){if(200===a){var c;try{c=JSON.parse(b)}catch(f){return __switch_zero.log("Request to Switch returned invalid JSON, calling DFP and ignoring Switch."),void __switch_zero.deliverAdUnits("bad_json")}if("pending"in c&&!0===c.pending){if(!1===__switch_zero.pollingActive)return void __switch_zero.log("Not continuing to poll, stop requested.");var d=__switch_zero.dateNow()-__switch_zero.lastSwitchRequestTime,e=__switch_zero.pollIntervalMs-d;return void(e<=0?__switch_zero.sendRequestToAdserver():__switch_zero.pollIntervalHandle=setTimeout(__switch_zero.sendRequestToAdserver.bind(this),e))}if(__switch_zero.stopPolling(),!(c.success&&"results"in c))return __switch_zero.log("Request to Switch failed, or returned no results, calling DFP and ignoring Switch."),void __switch_zero.deliverAdUnits("no_results");this.unusedResults=this.unusedResults.concat(c.results),this.assignAvailableAds(),c.hasOwnProperty("sync_uri")&&__switch_zero.doUserSync(c.sync_uri)}else __switch_zero.stopPolling(),__switch_zero.log("Retrieval HTTP request failure - going to DFP without Switch!"),__switch_zero.deliverAdUnits("http_error")},c.prototype.doUserSync=function(a){var b="__SWST";if(null===__switch_zero.readCookie(b)){a||(a="//delivery.swid.switchadhub.com/adserver/user_sync.php?do[sync]=1"),__switch_zero.writeCookie(b,"1",1800);try{var c=document.createElement("iframe");document.body.appendChild(c),c.setAttribute("seamless","seamless"),c.setAttribute("frameBorder","0"),c.setAttribute("frameSpacing","0"),c.setAttribute("scrolling","no"),c.setAttribute("style","border:none; padding: 0px; margin: 0px; position: absolute;"),c.setAttribute("width","0"),c.setAttribute("height","0"),c.src=a}catch(d){}}},c.prototype.assignAvailableAds=function(){clearTimeout(__switch_zero.userSyncTimeoutHandle);for(var a,b=[],c=0;c<this.unusedResults.length;c++){a=this.unusedResults[c];for(var d,e=null,f=0;f<__switch_zero.units.units.length;f++)if(d=__switch_zero.units.units[f],!1===d.hasWinner&&d.switchAdUnitId==a.zone_id){e=d;break}if(null!==e)if(__switch_zero.setDFPSlotTargeting(e,"_swcid",a.chain_id),a.remove=!0,"winner"in a&&!1!==a.winner){e.hasWinner=!0,e.winner=a.winner,e.chainId=a.chain_id;var g=!!e.hasOwnProperty("ceilingPrice")&&e.ceilingPrice,h=g&&e.winner.cpm>g||e.winner.force;if(!0===h)try{var i=__switch_zero.deliverAdUnitWithoutDFP(e);if(i)return;__switch_zero.log("Failed to deliver without DFP - continuing...")}catch(n){__switch_zero.log("Failed to deliver without DFP (error) - continuing...")}var j=(Math.floor(100*e.winner.cpm)/100).toFixed(2);j>20&&(j=20);var k=a.winner.width+"x"+a.winner.height;__switch_zero.setDFPSlotTargeting(e,"hb_bidder","switch"),__switch_zero.setDFPSlotTargeting(e,"hb_pb",j),__switch_zero.setDFPSlotTargeting(e,"hb_size",k),__switch_zero.setDFPSlotTargeting(e,"hb_adid",e.internalId),__switch_zero.setDFPSlotTargeting(e,"hb_time",__switch_zero.dateNow()),b.push(e)}else __switch_zero.setDFPSlotTargeting(e,"hb_fail","no_winner")}for(var l=0;l<b.length;l++)__switch_zero.deliverAdUnit(b[l],!0);var m=[];for(c=0;c<this.unusedResults.length;c++)this.unusedResults[c].hasOwnProperty("remove")&&!0===this.unusedResults[c].remove||m.push(this.unusedResults[c]);this.unusedResults=m},c.prototype.setTimeoutMs=function(a){this.timeoutMs=a},c.prototype.dateNow=DateNow,c.prototype.sendRequestToAdserver=function(){__switch_zero.lastSwitchRequestTime=__switch_zero.dateNow();var a=JSON.stringify({load_id:this.loadId,action:"retrieve",switch_user_id:__switch_zero.readCookie("__SW"),zero_start_time:__switch_zero.zeroStartTime,request_time:__switch_zero.dateNow()}),b=__switch_zero.createXMLHttpRequest();b.open("POST","//"+__switch_zero.adserverDomain+"/?load_id="+__switch_zero.loadId,!0),b.timeout=__switch_zero.timeoutMs,b.ontimeout=function(){__switch_zero.log("Retrieval HTTP request timed out to "+__switch_zero.adserverDomain+" - going to DFP without Switch!"),__switch_zero.deliverAdUnits("http_timeout")},b.onreadystatechange=function(){4===b.readyState&&__switch_zero.handleRetrievalResponse(b.status,b.responseText)},b.send(a)},c.prototype.removeSwitchTargetingFromAdUnit=function(a){__switch_zero.setDFPSlotTargeting(a,"hb_bidder",""),__switch_zero.setDFPSlotTargeting(a,"hb_pb",""),__switch_zero.setDFPSlotTargeting(a,"hb_size",""),__switch_zero.setDFPSlotTargeting(a,"hb_adid",""),__switch_zero.setDFPSlotTargeting(a,"hb_time",""),"chainId"in a&&__switch_zero.setDFPSlotTargeting(a,"_swcid",a.chainId+__switch_zero.dateNow())},c.prototype.render=function(a,b){if(!a||!b)throw new Error("Switch cannot render: Catastrophic failure.");var c=__switch_zero.units.getById(b);if(null===c||!1===c.hasWinner||!c.winner||!c.winner.creative)throw new Error("Switch cannot render for internal ID "+b+" - ad unit has no creative.");__switch_zero.removeSwitchTargetingFromAdUnit(c),a.write(c.winner.creative),a.close(),__switch_zero.triggerRenderCallbacks(c)},new c}();__switch_zero.commands.setReady();